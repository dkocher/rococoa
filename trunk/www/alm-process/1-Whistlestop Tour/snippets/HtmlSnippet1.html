<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />                                 <!--head> <style type="text/css"> .new {   font-weight: bold; } pre.block {   background-color: LightGoldenRodYellow;   white-space: pre;   font-family: courier;   font-size: 80%; } </style> </head> <body--> <h1>Rococoa Whistlestop Tour</h1>  <p>First download and unzip the latest release. Add dist/rococoa-0.1-SNAPSHOT.jar and the jars in lib to your classpath. Add bin/librococoa.dylib to your java.library.path.</p>  <p><strong>I'm about to gloss over some memory management issues. Please don't ship code based on Rococoa without getting at least as far that section. TODO - reference</strong></p>  <p>Now choose a Cocoa class you'd like to represent in Java. Let's say NSMutableArray. Create a Java interface called NSMutableArray, extending org.rococoa.NSObject.</p>  <pre class="block"><span class="new"><br />public interface NSMutableArray extends NSObject {<br />}<br /></span></pre>  <p>To create an NSMutableArray in Objective-C we would call the class (static) method + (id)arrayWithCapacity:(NSUInteger) numItems. We don't have any way to add static methods to a Java interface, so add a nested class and add the desired method to that.</p>  <pre class="block">public interface NSMutableArray extends NSObject {<br /><br />    <span class="new">public interface _Class extends NSClass {<br />        NSMutableArray arrayWithCapacity(int numItems);<br />    }</span>    <br />}<br /></pre>  <p>The nested class name _Class is just a convention. The method name should be the same as the Objective-C name, and primitive arguments just map to their obvious Java equivalents. The id returned we know represents an instance of NSMutableArray, so we may as well say so.</p>  <p>Now we need an instance of this inner class to call our method. Rococoa will create this for us, if we tell it the name of the Objective-C class that we are wrapping, and the type of the wrapper. I call these statics. CLASS</p>   <pre class="block">public interface NSMutableArray extends NSObject {<br /><br />    <span class="new">public static final _Class CLASS = Rococoa.createClass(&quot;NSMutableArray&quot;, _Class.class);</span><br />    <br />    public interface _Class extends NSClass {<br />        NSMutableArray arrayWithCapacity(int numItems);<br />    }<br />}<br /></pre>  <p>Now everything is in place to create an instance, let's do that and call the NSObject method - (NSString *)description, mapped in NSObject.java as String description().</p>  <pre class="block"><span class="new"><br />public class NSMutableArrayTest extends RococoaTestCase {<br /><br />    public void test() {<br />        NSMutableArray array = NSMutableArray.CLASS.arrayWithCapacity(3);<br />        assertEquals(&quot;(\n)&quot;, array.description());<br />    }   <br />}<br /></span></pre>  <p>OK, so it's not much of a description, but if it works, you've created an Objective-C object and called a method on it. Let's add some more interesting operations.</p>  <p>Provided that it is implemented in Objective-C, adding an operation is simply a question of adding to our Java interface. So in the parent of NSMutableArray, NSArray, we find - (NSUInteger)count. We can add that to our interface and then call it.</p>  <pre class="block">public interface NSMutableArray extends NSObject {<br /><br />    public static final _Class CLASS = Rococoa.createClass(&quot;NSMutableArray&quot;, Class.class);<br />    public interface _Class extends NSClass {<br />        NSMutableArray arrayWithCapacity(int numItems);<br />    }<br />    <br />    <span class="new">int count();</span><br />}<br /><br />public class NSMutableArrayTest extends RococoaTestCase {<br /><br />    public void test() {<br />        NSMutableArray array = NSMutableArray.CLASS.arrayWithCapacity(3);<br />        assertEquals(&quot;(\n)&quot;, array.description());<br />        <span class="new"><br />        assertEquals(0, array.count());</span><br />    }   <br />}<br /></pre>  <p>Hmmm, pretty boring, but necessary if we're going to test - (void)addObject:(id)anObject.</p>  <p>That (id) parameter is Objective-C's way of saying any NSObject, so the corresponding Java code is:</p>  <pre class="block">public interface NSMutableArray extends NSObject {<br /><br />    public static final _Class CLASS = Rococoa.createClass(&quot;NSMutableArray&quot;, _Class.class);<br />    public interface _Class extends NSClass {<br />        NSMutableArray arrayWithCapacity(int numItems);<br />    }<br />    <br />    int count();<br />    <span class="new"><br />    void addObject(NSObject anObject);</span><br />}.<br /></pre>  <p>The only NSObject subclass that we've seen so far is our NSMutableArray (OK, _Class is as well, smarty-pants), and adding an array to an array is too hardcore, so for our test be glad that Rococoa has already implemented some of NSString, and a factory method NSString stringWithString(java.lang.String string).</p>  <pre class="block">public class NSMutableArrayTest extends RococoaTestCase {<br /><br />    public void test() {<br />        NSMutableArray array = NSMutableArray.CLASS.arrayWithCapacity(3);<br />        assertEquals(0, array.count());<br />        <span class="new"><br />        NSString aString = NSString.stringWithString(&quot;Hello&quot;));<br />        array.addObject(aString);<br />        assertEquals(1, array.count());<br />        assertEquals(&quot;(\n    Hello\n)&quot;, array.description());</span><br />    }   <br />}<br /></pre>  <p>As passing strings around is pretty fundamental, Rococoa marsalls them specially. If you declare a parameter as java.lang.String, Rococoa will create the NSString for you.</p>  <pre class="block">public interface NSMutableArray extends NSObject {<br /><br />    public static final _Class CLASS = Rococoa.createClass(&quot;NSMutableArray&quot;, _Class.class);<br />    public interface _Class extends NSClass {<br />        NSMutableArray arrayWithCapacity(int numItems);<br />    }<br />    <br />    int count();<br />    void addObject(NSObject anObject);<br />    <span class="new"><br />    void addObject(String string);</span><br /><br />}<br /><br />public class NSMutableArrayTest extends RococoaTestCase {<br /><br />    public void test() {<br />        NSMutableArray array = NSMutableArray.CLASS.arrayWithCapacity(3);<br />        assertEquals(0, array.count());<br />        array.addObject(NSString.stringWithString(&quot;Hello&quot;));<br />        <span class="new"><br />        array.addObject(&quot;Goodbye&quot;);<br />        assertEquals(2, array.count());<br />        assertEquals(&quot;(\n    Hello,\n    Goodbye\n)&quot;,<br />array.description());</span><br />    }   <br />}<br /></pre>  <p>The same is true for returning strings.</p>  <pre class="block">public interface NSMutableArray extends NSObject {<br /><br />    public static final _Class CLASS = Rococoa.createClass(&quot;NSMutableArray&quot;, _Class.class);<br />    public interface _Class extends NSClass {<br />        NSMutableArray arrayWithCapacity(int numItems);<br />    }<br />    <br />    int count();<br />    void addObject(NSObject anObject);<br />    void addObject(String string);<br />    <span class="new"><br />    String objectAtIndex(int index);</span><br /><br />}<br /><br />public class NSMutableArrayTest extends RococoaTestCase {<br /><br />    public void test() {<br />        NSMutableArray array = NSMutableArray.CLASS.arrayWithCapacity(3);<br />        assertEquals(0, array.count());<br />        array.addObject(NSString.stringWithString(&quot;Hello&quot;));<br />        array.addObject(&quot;Goodbye&quot;);<br />        assertEquals(2, array.count());<br />        <span class="new"><br />        String first = array.objectAtIndex(0);<br />        assertEquals(&quot;Hello&quot;, first);<br />        assertEquals(&quot;Goodbye&quot;, array.objectAtIndex(1));</span><br />    }   <br />}<br /></pre>  <p>Of course we can't overload String objectAtIndex(int index) and add the more generic NSObject objectAtIndex(int index). Let's go back to returning NSObject.</p>  <pre class="block">public interface NSMutableArray extends NSObject {<br /><br />    public static final _Class CLASS = Rococoa.createClass(&quot;NSMutableArray&quot;, _Class.class);<br />    public interface _Class extends NSClass {<br />        NSMutableArray arrayWithCapacity(int numItems);<br />    }<br />    <br />    int count();<br />    void addObject(NSObject anObject);<br />    void addObject(String string);<br />    <br />    NSObject objectAtIndex(int index);<br />}<br /></pre>  <p>Now we can compare with an NSString.</p>  <pre class="block">public class NSMutableArrayTest extends RococoaTestCase {<br /><br />    public void test() {<br />        NSMutableArray array = NSMutableArray.CLASS.arrayWithCapacity(3);<br />        assertEquals(0, array.count());<br />        array.addObject(NSString.stringWithString(&quot;Hello&quot;));<br />        array.addObject(&quot;Goodbye&quot;);<br />        assertEquals(2, array.count());<br />        <span class="new"><br />        NSObject first = array.objectAtIndex(0);<br />        assertEquals(NSString.stringWithString(&quot;Hello&quot;), first);</span><br />    }   <br />}<br /></pre>  <p>Alternatively we can downcast to NSString using Rococoa.cast(NSObject object, Class desiredType).</p>  <pre class="block">public class NSMutableArrayTest extends RococoaTestCase {<br /><br />    public void test() {<br />        NSMutableArray array = NSMutableArray.CLASS.arrayWithCapacity(3);<br />        assertEquals(0, array.count());<br />        array.addObject(NSString.stringWithString(&quot;Hello&quot;));<br />        array.addObject(&quot;Goodbye&quot;);<br />        assertEquals(2, array.count());<br /><br />        NSObject first = array.objectAtIndex(0);<br />        assertEquals(NSString.stringWithString(&quot;Hello&quot;), first);<br />        <span class="new"><br />        NSString firstAsString = Rococoa.cast(first, NSString.class);<br />        assertEquals(&quot;Hello&quot;, firstAsString.toString());<br />        assertEquals(&quot;Goodbye&quot;, <br />                Rococoa.cast(array.objectAtIndex(1), NSString.class).toString());</span><br /><br />    }   <br />}<br /></pre>  <p>That's the end of our quick tour. I thought there were too many apostrophes, but if that hasn't put you off, please read on. <br /></p> 